!function(t){"use strict";var n=function(n){n&&n("core","snapToGrid",function(n){var i=this,o=n,e=i.container(),r={stackOrder:-1,gridSpacing:40,strokeStyle:"#CCCCCC",lineWidth:1,lineDash:[5,8],zoomDash:!0,panGrid:!0,snapToGrid:!0,drawGrid:!0,selector:void 0},a={snapOn:function(){t(this).trigger("snaptogrid.snapon")},snapOff:function(){t(this).trigger("snaptogrid.snapoff")},gridOn:function(){t(this).trigger("snaptogrid.gridon")},gridOff:function(){t(this).trigger("snaptogrid.gridoff")},refresh:function(){t(this).trigger("snaptogrid.refresh")},option:function(n,i){var o=t(this),e=o.data("snapToGrid");if(null!=e){var r=e.options;if(void 0===i){if(typeof n!=typeof{})return r[n];var a=n;r=t.extend(!0,{},defaults,a),e.options=r}else r[n]=i;return o.data("snapToGrid",e),o.trigger("snaptogrid.refresh"),o}},init:function(){var o,e=t("<canvas></canvas>"),a=t(this),s=t.extend(!0,{},r,n);a.data("snapToGrid",s);var d,f=function(){return d||(d=a.data("snapToGrid"))},p=function(){e.attr("height",a.height()).attr("width",a.width()).css({position:"absolute",top:0,left:0,"z-index":f().stackOrder}),setTimeout(function(){var t=e.offset(),n=a.offset();e.attr("height",a.height()).attr("width",a.width()).css({top:-(t.top-n.top),left:-(t.left-n.left)}),c()},0)},c=function(){if(g(),f().drawGrid){var t=i.zoom(),n=a.width(),e=a.height(),r=f().gridSpacing*t,s=i.pan(),d=s.x%r,p=s.y%r;if(o.strokeStyle=f().strokeStyle,o.lineWidth=f().lineWidth,f().zoomDash){for(var c=f().lineDash.slice(),h=0;h<c.length;h++)c[h]=f().lineDash[h]*t;o.setLineDash(c)}else o.setLineDash(f().lineDash);f().panGrid?o.lineDashOffset=-s.y:o.lineDashOffset=0;for(h=d;h<n;h+=r)o.beginPath(),o.moveTo(h,0),o.lineTo(h,e),o.stroke();f().panGrid?o.lineDashOffset=-s.x:o.lineDashOffset=0;for(h=p;h<e;h+=r)o.beginPath(),o.moveTo(0,h),o.lineTo(n,h),o.stroke()}},g=function(){var t=a.width(),n=a.height();o.clearRect(0,0,t,n)},h=function(t){var n=t.position(),i=Math.floor(n.x/f().gridSpacing),o=Math.floor(n.y/f().gridSpacing);t.position({x:(i+.5)*f().gridSpacing,y:(o+.5)*f().gridSpacing})},l=function(){i.nodes(f().selector).each(function(t){h(t)})},u=function(t){f().snapToGrid&&(void 0===f().selector||t.target.filter(f().selector).length>0)&&h(t.target)},y=function(t){f().snapToGrid&&(void 0===f().selector||t.target.filter(f().selector).length>0)&&h(t.target)};a.append(e),t(window).on("resize",p),a.on("snaptogrid.snapon",function(){f().snapToGrid=!0,l()}),a.on("snaptogrid.snapoff",function(){f().snapToGrid=!1}),a.on("snaptogrid.gridon",function(){f().drawGrid=!0,c()}),a.on("snaptogrid.gridoff",function(){f().drawGrid=!1,c()}),a.on("snaptogrid.refresh",p),o=e[0].getContext("2d"),i.ready(function(){p(),f().snapToGrid&&l(),i.on("zoom",c),i.on("pan",c),i.on("free",u),i.on("add",y)})}};return a[o]?a[o].apply(e,Array.prototype.slice.call(arguments,1)):"object"!=typeof o&&o?(console.error("No such function `"+o+"` for snapToGrid"),this):a.init.apply(e,arguments)})};"undefined"!=typeof module&&module.exports&&(module.exports=n),"undefined"!=typeof define&&define.amd&&define("cytoscape-snap-to-grid",function(){return n}),"undefined"!=typeof cytoscape&&n(cytoscape)}("undefined"!=typeof jQuery?jQuery:null);