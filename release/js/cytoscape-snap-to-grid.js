!function(n){"use strict";var i=function(i){i&&i("core","snapToGrid",function(i){var t=this,o=i,e=t.container(),r={stackOrder:-1,gridSpacing:40,strokeStyle:"#CCCCCC",lineWidth:1,lineDash:[5,8],zoomDash:!0,panGrid:!0,snapToGrid:!0,drawGrid:!0},a={snapOn:function(){n(this).trigger("snaptogrid.snapon")},snapOff:function(){n(this).trigger("snaptogrid.snapoff")},gridOn:function(){n(this).trigger("snaptogrid.gridon")},gridOff:function(){n(this).trigger("snaptogrid.gridoff")},refresh:function(){n(this).trigger("snaptogrid.refresh")},option:function(i,t){var o=n(this),e=o.data("snapToGrid");if(null!=e){var r=e.options;if(void 0===t){if(typeof i!=typeof{})return r[i];var a=i;r=n.extend(!0,{},defaults,a),e.options=r}else r[i]=t;return o.data("snapToGrid",e),o.trigger("snaptogrid.refresh"),o}},init:function(){var o,e=n("<canvas></canvas>"),a=n(this),s=n.extend(!0,{},r,i);a.data("snapToGrid",s);var d,f=function(){return d||(d=a.data("snapToGrid"))},p=function(){e.attr("height",a.height()).attr("width",a.width()).css({position:"absolute",top:0,left:0,"z-index":f().stackOrder}),setTimeout(function(){var n=e.offset(),i=a.offset();e.attr("height",a.height()).attr("width",a.width()).css({top:-(n.top-i.top),left:-(n.left-i.left)}),c()},0)},c=function(){if(g(),f().drawGrid){var n=t.zoom(),i=a.width(),e=a.height(),r=f().gridSpacing*n,s=t.pan(),d=s.x%r,p=s.y%r;if(o.strokeStyle=f().strokeStyle,o.lineWidth=f().lineWidth,f().zoomDash){for(var c=f().lineDash.slice(),h=0;h<c.length;h++)c[h]=f().lineDash[h]*n;o.setLineDash(c)}else o.setLineDash(f().lineDash);f().panGrid?o.lineDashOffset=-s.y:o.lineDashOffset=0;for(h=d;h<i;h+=r)o.beginPath(),o.moveTo(h,0),o.lineTo(h,e),o.stroke();f().panGrid?o.lineDashOffset=-s.x:o.lineDashOffset=0;for(h=p;h<e;h+=r)o.beginPath(),o.moveTo(0,h),o.lineTo(i,h),o.stroke()}},g=function(){var n=a.width(),i=a.height();o.clearRect(0,0,n,i)},h=function(n){var i=n.position(),t=Math.floor(i.x/f().gridSpacing),o=Math.floor(i.y/f().gridSpacing);n.position({x:(t+.5)*f().gridSpacing,y:(o+.5)*f().gridSpacing})},u=function(){t.nodes().each(function(n){h(n)})},l=function(n){f().snapToGrid&&h(n.target)},y=function(n){f().snapToGrid&&h(n.target)};a.append(e),n(window).on("resize",p),a.on("snaptogrid.snapon",function(){f().snapToGrid=!0,u()}),a.on("snaptogrid.snapoff",function(){f().snapToGrid=!1}),a.on("snaptogrid.gridon",function(){f().drawGrid=!0,c()}),a.on("snaptogrid.gridoff",function(){f().drawGrid=!1,c()}),a.on("snaptogrid.refresh",p),o=e[0].getContext("2d"),t.ready(function(){p(),f().snapToGrid&&u(),t.on("zoom",c),t.on("pan",c),t.on("free",l),t.on("add",y)})}};return a[o]?a[o].apply(e,Array.prototype.slice.call(arguments,1)):"object"!=typeof o&&o?(console.error("No such function `"+o+"` for snapToGrid"),this):a.init.apply(e,arguments)})};"undefined"!=typeof module&&module.exports&&(module.exports=i),"undefined"!=typeof define&&define.amd&&define("cytoscape-snap-to-grid",function(){return i}),"undefined"!=typeof cytoscape&&i(cytoscape)}("undefined"!=typeof jQuery?jQuery:null);